
# Pandas进阶及技巧

## 1. 创建Pandas


```python
import pandas as pd

country1 = pd.Series({'Name': '中国',
                    'Language': 'Chinese',
                    'Area': '9.597M km2',
                     'Happiness Rank': 79})

country2 = pd.Series({'Name': '美国',
                    'Language': 'English (US)',
                    'Area': '9.834M km2',
                     'Happiness Rank': 14})

country3 = pd.Series({'Name': '澳大利亚',
                    'Language': 'English (AU)',
                    'Area': '7.692M km2',
                     'Happiness Rank': 9})

df = pd.DataFrame([country1, country2, country3], index=['CH', 'US', 'AU'])
```


```python
# 注意在jupyter中使用print和不使用print的区别
print(df)
df
```

              Area  Happiness Rank      Language  Name
    CH  9.597M km2              79       Chinese    中国
    US  9.834M km2              14  English (US)    美国
    AU  7.692M km2               9  English (AU)  澳大利亚
    




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Area</th>
      <th>Happiness Rank</th>
      <th>Language</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CH</th>
      <td>9.597M km2</td>
      <td>79</td>
      <td>Chinese</td>
      <td>中国</td>
    </tr>
    <tr>
      <th>US</th>
      <td>9.834M km2</td>
      <td>14</td>
      <td>English (US)</td>
      <td>美国</td>
    </tr>
    <tr>
      <th>AU</th>
      <td>7.692M km2</td>
      <td>9</td>
      <td>English (AU)</td>
      <td>澳大利亚</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 添加数据
# 如果个数小于要求的个数，会自动进行“广播”操作
# 如果大于要求的个数，会报错
df['Location'] = '地球'
print(df)

df['Region'] = ['亚洲', '北美洲', '大洋洲']
print(df)
df
```

              Area  Happiness Rank      Language  Name Location
    CH  9.597M km2              79       Chinese    中国       地球
    US  9.834M km2              14  English (US)    美国       地球
    AU  7.692M km2               9  English (AU)  澳大利亚       地球
              Area  Happiness Rank      Language  Name Location Region
    CH  9.597M km2              79       Chinese    中国       地球     亚洲
    US  9.834M km2              14  English (US)    美国       地球    北美洲
    AU  7.692M km2               9  English (AU)  澳大利亚       地球    大洋洲
    




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Area</th>
      <th>Happiness Rank</th>
      <th>Language</th>
      <th>Name</th>
      <th>Location</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CH</th>
      <td>9.597M km2</td>
      <td>79</td>
      <td>Chinese</td>
      <td>中国</td>
      <td>地球</td>
      <td>亚洲</td>
    </tr>
    <tr>
      <th>US</th>
      <td>9.834M km2</td>
      <td>14</td>
      <td>English (US)</td>
      <td>美国</td>
      <td>地球</td>
      <td>北美洲</td>
    </tr>
    <tr>
      <th>AU</th>
      <td>7.692M km2</td>
      <td>9</td>
      <td>English (AU)</td>
      <td>澳大利亚</td>
      <td>地球</td>
      <td>大洋洲</td>
    </tr>
  </tbody>
</table>
</div>



## 2. Pandas索引


```python
# 行索引
print('loc:')
print(df.loc['CH'])
print(type(df.loc['CH']))

print('iloc:')
print(df.iloc[1])
```

    loc:
    Area              9.597M km2
    Happiness Rank            79
    Language             Chinese
    Name                      中国
    Location                  地球
    Region                    亚洲
    Name: CH, dtype: object
    <class 'pandas.core.series.Series'>
    iloc:
    Area                9.834M km2
    Happiness Rank              14
    Language          English (US)
    Name                        美国
    Location                    地球
    Region                     北美洲
    Name: US, dtype: object
    


```python
# 列索引
print(df['Area'])
print(type(df['Area']))
```

    CH    9.597M km2
    US    9.834M km2
    AU    7.692M km2
    Name: Area, dtype: object
    <class 'pandas.core.series.Series'>
    


```python
# 获取不连续的列数据
print(df[['Name', 'Area']])
```

        Name        Area
    CH    中国  9.597M km2
    US    美国  9.834M km2
    AU  澳大利亚  7.692M km2
    


```python
# 混合索引
# 注意写法上的区别
print('先取出列，再取行：')
print(df['Area']['CH'])
print(df['Area'].loc['CH'])
print(df['Area'].iloc[0])

print('先取出行，再取列：')
print(df.loc['CH']['Area'])
print(df.iloc[0]['Area'])
```

    先取出列，再取行：
    9.597M km2
    9.597M km2
    9.597M km2
    先取出行，再取列：
    9.597M km2
    9.597M km2
    


```python
# 转换行和列
print(df.T)
```

                            CH            US            AU
    Area            9.597M km2    9.834M km2    7.692M km2
    Happiness Rank          79            14             9
    Language           Chinese  English (US)  English (AU)
    Name                    中国            美国          澳大利亚
    Location                地球            地球            地球
    Region                  亚洲           北美洲           大洋洲
    

## 3. 删除数据


```python
print(df.drop(['CH']))
# 注意drop操作只是将修改后的数据copy一份，而不会对原始数据进行修改
print(df)
```

              Area  Happiness Rank      Language  Name Location Region
    US  9.834M km2              14  English (US)    美国       地球    北美洲
    AU  7.692M km2               9  English (AU)  澳大利亚       地球    大洋洲
              Area  Happiness Rank      Language  Name Location Region
    CH  9.597M km2              79       Chinese    中国       地球     亚洲
    US  9.834M km2              14  English (US)    美国       地球    北美洲
    AU  7.692M km2               9  English (AU)  澳大利亚       地球    大洋洲
    


```python
print(df.drop(['CH'], inplace=True))
# 如果使用了inplace=True，会在原始数据上进行修改，同时不会返回一个copy
print(df)
```

    None
              Area  Happiness Rank      Language  Name Location Region
    US  9.834M km2              14  English (US)    美国       地球    北美洲
    AU  7.692M km2               9  English (AU)  澳大利亚       地球    大洋洲
    


```python
#  如果需要删除列，需要指定axis=1
print(df.drop(['Area'], axis=1))
print(df)
```

        Happiness Rank      Language  Name Location Region
    US              14  English (US)    美国       地球    北美洲
    AU               9  English (AU)  澳大利亚       地球    大洋洲
              Area  Happiness Rank      Language  Name Location Region
    US  9.834M km2              14  English (US)    美国       地球    北美洲
    AU  7.692M km2               9  English (AU)  澳大利亚       地球    大洋洲
    


```python
# 也可直接使用del关键字
del df['Name']
print(df)
```

              Area  Happiness Rank      Language Location Region
    US  9.834M km2              14  English (US)       地球    北美洲
    AU  7.692M km2               9  English (AU)       地球    大洋洲
    

## 4. DataFrame的操作与加载


```python
# 注意从DataFrame中取出的数据进行操作后，会对原始数据产生影响
ranks = df['Happiness Rank']
ranks += 2
print(ranks)
print(df)
```

    US    16
    AU    11
    Name: Happiness Rank, dtype: int64
              Area  Happiness Rank      Language Location Region
    US  9.834M km2              16  English (US)       地球    北美洲
    AU  7.692M km2              11  English (AU)       地球    大洋洲
    


```python
# 注意从DataFrame中取出的数据进行操作后，会对原始数据产生影响
# 安全的操作是使用copy()
ranks = df['Happiness Rank'].copy()
ranks += 2
print(ranks)
print(df)
```

    US    18
    AU    13
    Name: Happiness Rank, dtype: int64
              Area  Happiness Rank      Language Location Region
    US  9.834M km2              16  English (US)       地球    北美洲
    AU  7.692M km2              11  English (AU)       地球    大洋洲
    


```python
# 加载csv文件数据
reprot_2015_df = pd.read_csv('./2015.csv')
print('2015年数据预览：')
#print(reprot_2015_df.head())
reprot_2015_df.head()
```

    2015年数据预览：
    




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Region</th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Switzerland</td>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Iceland</td>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Denmark</td>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Norway</td>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Canada</td>
      <td>North America</td>
      <td>5</td>
      <td>7.427</td>
      <td>0.03553</td>
      <td>1.32629</td>
      <td>1.32261</td>
      <td>0.90563</td>
      <td>0.63297</td>
      <td>0.32957</td>
      <td>0.45811</td>
      <td>2.45176</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(reprot_2015_df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 158 entries, 0 to 157
    Data columns (total 12 columns):
    Country                          158 non-null object
    Region                           158 non-null object
    Happiness Rank                   158 non-null int64
    Happiness Score                  158 non-null float64
    Standard Error                   158 non-null float64
    Economy (GDP per Capita)         158 non-null float64
    Family                           158 non-null float64
    Health (Life Expectancy)         158 non-null float64
    Freedom                          158 non-null float64
    Trust (Government Corruption)    158 non-null float64
    Generosity                       158 non-null float64
    Dystopia Residual                158 non-null float64
    dtypes: float64(9), int64(1), object(2)
    memory usage: 14.9+ KB
    None
    


```python
# 使用index_col指定索引列
# 使用usecols指定需要读取的列
reprot_2016_df = pd.read_csv('./2016.csv', 
                             index_col='Country',
                             usecols=['Country', 'Happiness Rank', 'Happiness Score', 'Region'])
# 数据预览
reprot_2016_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Denmark</th>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.526</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.509</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.501</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.498</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>Western Europe</td>
      <td>5</td>
      <td>7.413</td>
    </tr>
  </tbody>
</table>
</div>




```python
print('列名(column)：', reprot_2016_df.columns)
print('行名(index)：', reprot_2016_df.index)
```

    列名(column)： Index(['Region', 'Happiness Rank', 'Happiness Score'], dtype='object')
    行名(index)： Index(['Denmark', 'Switzerland', 'Iceland', 'Norway', 'Finland', 'Canada',
           'Netherlands', 'New Zealand', 'Australia', 'Sweden',
           ...
           'Madagascar', 'Tanzania', 'Liberia', 'Guinea', 'Rwanda', 'Benin',
           'Afghanistan', 'Togo', 'Syria', 'Burundi'],
          dtype='object', name='Country', length=157)
    


```python
# 注意index是不可变的
reprot_2016_df.index[0] = '丹麦'
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    <ipython-input-19-fe3f4b6af8cf> in <module>()
          1 # 注意index是不可变的
    ----> 2 reprot_2016_df.index[0] = '丹麦'
    

    D:\Users\Jimmy\Anaconda3\lib\site-packages\pandas\core\indexes\base.py in __setitem__(self, key, value)
       1618 
       1619     def __setitem__(self, key, value):
    -> 1620         raise TypeError("Index does not support mutable operations")
       1621 
       1622     def __getitem__(self, key):
    

    TypeError: Index does not support mutable operations



```python
# 重置index
# 注意inplace加与不加的区别
reprot_2016_df.reset_index().head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Region</th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Denmark</td>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.526</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Switzerland</td>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.509</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Iceland</td>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.501</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Norway</td>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.498</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Finland</td>
      <td>Western Europe</td>
      <td>5</td>
      <td>7.413</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 重命名列名
reprot_2016_df.rename(columns={'Region': '地区', 'Hapiness Rank': '排名', 'Hapiness Score': '幸福指数'})
reprot_2016_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Denmark</th>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.526</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.509</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.501</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.498</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>Western Europe</td>
      <td>5</td>
      <td>7.413</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 重命名列名，注意inplace的使用
reprot_2016_df.rename(columns={'Region': '地区', 'Happiness Rank': '排名', 'Happiness Score': '幸福指数'},
                     inplace=True)
reprot_2016_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地区</th>
      <th>排名</th>
      <th>幸福指数</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Denmark</th>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.526</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.509</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.501</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.498</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>Western Europe</td>
      <td>5</td>
      <td>7.413</td>
    </tr>
  </tbody>
</table>
</div>



## 5. Boolean Mask


```python
# 过滤 Western Europe 地区的国家
only_western_europe = reprot_2016_df['地区'] == 'Western Europe'
only_western_europe
```




    Country
    Denmark                  True
    Switzerland              True
    Iceland                  True
    Norway                   True
    Finland                  True
    Canada                  False
    Netherlands              True
    New Zealand             False
    Australia               False
    Sweden                   True
    Israel                  False
    Austria                  True
    United States           False
    Costa Rica              False
    Puerto Rico             False
    Germany                  True
    Brazil                  False
    Belgium                  True
    Ireland                  True
    Luxembourg               True
    Mexico                  False
    Singapore               False
    United Kingdom           True
    Chile                   False
    Panama                  False
    Argentina               False
    Czech Republic          False
    United Arab Emirates    False
    Uruguay                 False
    Malta                    True
                            ...  
    Senegal                 False
    Bulgaria                False
    Mauritania              False
    Zimbabwe                False
    Malawi                  False
    Sudan                   False
    Gabon                   False
    Mali                    False
    Haiti                   False
    Botswana                False
    Comoros                 False
    Ivory Coast             False
    Cambodia                False
    Angola                  False
    Niger                   False
    South Sudan             False
    Chad                    False
    Burkina Faso            False
    Uganda                  False
    Yemen                   False
    Madagascar              False
    Tanzania                False
    Liberia                 False
    Guinea                  False
    Rwanda                  False
    Benin                   False
    Afghanistan             False
    Togo                    False
    Syria                   False
    Burundi                 False
    Name: 地区, Length: 157, dtype: bool




```python
# 过滤 Western Europe 地区的国家
# 并且排名在10之外
only_western_europe_10 = (reprot_2016_df['地区'] == 'Western Europe') & (reprot_2016_df['排名'] > 10)
only_western_europe_10
```




    Country
    Denmark                 False
    Switzerland             False
    Iceland                 False
    Norway                  False
    Finland                 False
    Canada                  False
    Netherlands             False
    New Zealand             False
    Australia               False
    Sweden                  False
    Israel                  False
    Austria                  True
    United States           False
    Costa Rica              False
    Puerto Rico             False
    Germany                  True
    Brazil                  False
    Belgium                  True
    Ireland                  True
    Luxembourg               True
    Mexico                  False
    Singapore               False
    United Kingdom           True
    Chile                   False
    Panama                  False
    Argentina               False
    Czech Republic          False
    United Arab Emirates    False
    Uruguay                 False
    Malta                    True
                            ...  
    Senegal                 False
    Bulgaria                False
    Mauritania              False
    Zimbabwe                False
    Malawi                  False
    Sudan                   False
    Gabon                   False
    Mali                    False
    Haiti                   False
    Botswana                False
    Comoros                 False
    Ivory Coast             False
    Cambodia                False
    Angola                  False
    Niger                   False
    South Sudan             False
    Chad                    False
    Burkina Faso            False
    Uganda                  False
    Yemen                   False
    Madagascar              False
    Tanzania                False
    Liberia                 False
    Guinea                  False
    Rwanda                  False
    Benin                   False
    Afghanistan             False
    Togo                    False
    Syria                   False
    Burundi                 False
    Length: 157, dtype: bool




```python
# 叠加 boolean mask 得到最终结果
reprot_2016_df[only_western_europe_10]
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地区</th>
      <th>排名</th>
      <th>幸福指数</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Austria</th>
      <td>Western Europe</td>
      <td>12</td>
      <td>7.119</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>Western Europe</td>
      <td>16</td>
      <td>6.994</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>Western Europe</td>
      <td>18</td>
      <td>6.929</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>Western Europe</td>
      <td>19</td>
      <td>6.907</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>Western Europe</td>
      <td>20</td>
      <td>6.871</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>Western Europe</td>
      <td>23</td>
      <td>6.725</td>
    </tr>
    <tr>
      <th>Malta</th>
      <td>Western Europe</td>
      <td>30</td>
      <td>6.488</td>
    </tr>
    <tr>
      <th>France</th>
      <td>Western Europe</td>
      <td>32</td>
      <td>6.478</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>Western Europe</td>
      <td>37</td>
      <td>6.361</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>Western Europe</td>
      <td>50</td>
      <td>5.977</td>
    </tr>
    <tr>
      <th>North Cyprus</th>
      <td>Western Europe</td>
      <td>62</td>
      <td>5.771</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>Western Europe</td>
      <td>69</td>
      <td>5.546</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>Western Europe</td>
      <td>94</td>
      <td>5.123</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>Western Europe</td>
      <td>99</td>
      <td>5.033</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 熟练以后可以写在一行中
reprot_2016_df[(reprot_2016_df['地区'] == 'Western Europe') & (reprot_2016_df['排名'] > 10)]
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地区</th>
      <th>排名</th>
      <th>幸福指数</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Austria</th>
      <td>Western Europe</td>
      <td>12</td>
      <td>7.119</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>Western Europe</td>
      <td>16</td>
      <td>6.994</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>Western Europe</td>
      <td>18</td>
      <td>6.929</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>Western Europe</td>
      <td>19</td>
      <td>6.907</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>Western Europe</td>
      <td>20</td>
      <td>6.871</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>Western Europe</td>
      <td>23</td>
      <td>6.725</td>
    </tr>
    <tr>
      <th>Malta</th>
      <td>Western Europe</td>
      <td>30</td>
      <td>6.488</td>
    </tr>
    <tr>
      <th>France</th>
      <td>Western Europe</td>
      <td>32</td>
      <td>6.478</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>Western Europe</td>
      <td>37</td>
      <td>6.361</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>Western Europe</td>
      <td>50</td>
      <td>5.977</td>
    </tr>
    <tr>
      <th>North Cyprus</th>
      <td>Western Europe</td>
      <td>62</td>
      <td>5.771</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>Western Europe</td>
      <td>69</td>
      <td>5.546</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>Western Europe</td>
      <td>94</td>
      <td>5.123</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>Western Europe</td>
      <td>99</td>
      <td>5.033</td>
    </tr>
  </tbody>
</table>
</div>



## 6. 层级索引


```python
reprot_2015_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Region</th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Switzerland</td>
      <td>Western Europe</td>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Iceland</td>
      <td>Western Europe</td>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Denmark</td>
      <td>Western Europe</td>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Norway</td>
      <td>Western Europe</td>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Canada</td>
      <td>North America</td>
      <td>5</td>
      <td>7.427</td>
      <td>0.03553</td>
      <td>1.32629</td>
      <td>1.32261</td>
      <td>0.90563</td>
      <td>0.63297</td>
      <td>0.32957</td>
      <td>0.45811</td>
      <td>2.45176</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 设置层级索引
report_2015_df2 = reprot_2015_df.set_index(['Region', 'Country'])
report_2015_df2.head(20)
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Western Europe</th>
      <th>Switzerland</th>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>North America</th>
      <th>Canada</th>
      <td>5</td>
      <td>7.427</td>
      <td>0.03553</td>
      <td>1.32629</td>
      <td>1.32261</td>
      <td>0.90563</td>
      <td>0.63297</td>
      <td>0.32957</td>
      <td>0.45811</td>
      <td>2.45176</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Western Europe</th>
      <th>Finland</th>
      <td>6</td>
      <td>7.406</td>
      <td>0.03140</td>
      <td>1.29025</td>
      <td>1.31826</td>
      <td>0.88911</td>
      <td>0.64169</td>
      <td>0.41372</td>
      <td>0.23351</td>
      <td>2.61955</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>7</td>
      <td>7.378</td>
      <td>0.02799</td>
      <td>1.32944</td>
      <td>1.28017</td>
      <td>0.89284</td>
      <td>0.61576</td>
      <td>0.31814</td>
      <td>0.47610</td>
      <td>2.46570</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>8</td>
      <td>7.364</td>
      <td>0.03157</td>
      <td>1.33171</td>
      <td>1.28907</td>
      <td>0.91087</td>
      <td>0.65980</td>
      <td>0.43844</td>
      <td>0.36262</td>
      <td>2.37119</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Australia and New Zealand</th>
      <th>New Zealand</th>
      <td>9</td>
      <td>7.286</td>
      <td>0.03371</td>
      <td>1.25018</td>
      <td>1.31967</td>
      <td>0.90837</td>
      <td>0.63938</td>
      <td>0.42922</td>
      <td>0.47501</td>
      <td>2.26425</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>10</td>
      <td>7.284</td>
      <td>0.04083</td>
      <td>1.33358</td>
      <td>1.30923</td>
      <td>0.93156</td>
      <td>0.65124</td>
      <td>0.35637</td>
      <td>0.43562</td>
      <td>2.26646</td>
    </tr>
    <tr>
      <th>Middle East and Northern Africa</th>
      <th>Israel</th>
      <td>11</td>
      <td>7.278</td>
      <td>0.03470</td>
      <td>1.22857</td>
      <td>1.22393</td>
      <td>0.91387</td>
      <td>0.41319</td>
      <td>0.07785</td>
      <td>0.33172</td>
      <td>3.08854</td>
    </tr>
    <tr>
      <th>Latin America and Caribbean</th>
      <th>Costa Rica</th>
      <td>12</td>
      <td>7.226</td>
      <td>0.04454</td>
      <td>0.95578</td>
      <td>1.23788</td>
      <td>0.86027</td>
      <td>0.63376</td>
      <td>0.10583</td>
      <td>0.25497</td>
      <td>3.17728</td>
    </tr>
    <tr>
      <th>Western Europe</th>
      <th>Austria</th>
      <td>13</td>
      <td>7.200</td>
      <td>0.03751</td>
      <td>1.33723</td>
      <td>1.29704</td>
      <td>0.89042</td>
      <td>0.62433</td>
      <td>0.18676</td>
      <td>0.33088</td>
      <td>2.53320</td>
    </tr>
    <tr>
      <th>Latin America and Caribbean</th>
      <th>Mexico</th>
      <td>14</td>
      <td>7.187</td>
      <td>0.04176</td>
      <td>1.02054</td>
      <td>0.91451</td>
      <td>0.81444</td>
      <td>0.48181</td>
      <td>0.21312</td>
      <td>0.14074</td>
      <td>3.60214</td>
    </tr>
    <tr>
      <th>North America</th>
      <th>United States</th>
      <td>15</td>
      <td>7.119</td>
      <td>0.03839</td>
      <td>1.39451</td>
      <td>1.24711</td>
      <td>0.86179</td>
      <td>0.54604</td>
      <td>0.15890</td>
      <td>0.40105</td>
      <td>2.51011</td>
    </tr>
    <tr>
      <th>Latin America and Caribbean</th>
      <th>Brazil</th>
      <td>16</td>
      <td>6.983</td>
      <td>0.04076</td>
      <td>0.98124</td>
      <td>1.23287</td>
      <td>0.69702</td>
      <td>0.49049</td>
      <td>0.17521</td>
      <td>0.14574</td>
      <td>3.26001</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Western Europe</th>
      <th>Luxembourg</th>
      <td>17</td>
      <td>6.946</td>
      <td>0.03499</td>
      <td>1.56391</td>
      <td>1.21963</td>
      <td>0.91894</td>
      <td>0.61583</td>
      <td>0.37798</td>
      <td>0.28034</td>
      <td>1.96961</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>18</td>
      <td>6.940</td>
      <td>0.03676</td>
      <td>1.33596</td>
      <td>1.36948</td>
      <td>0.89533</td>
      <td>0.61777</td>
      <td>0.28703</td>
      <td>0.45901</td>
      <td>1.97570</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>19</td>
      <td>6.937</td>
      <td>0.03595</td>
      <td>1.30782</td>
      <td>1.28566</td>
      <td>0.89667</td>
      <td>0.58450</td>
      <td>0.22540</td>
      <td>0.22250</td>
      <td>2.41484</td>
    </tr>
    <tr>
      <th>Middle East and Northern Africa</th>
      <th>United Arab Emirates</th>
      <td>20</td>
      <td>6.901</td>
      <td>0.03729</td>
      <td>1.42727</td>
      <td>1.12575</td>
      <td>0.80925</td>
      <td>0.64157</td>
      <td>0.38583</td>
      <td>0.26428</td>
      <td>2.24743</td>
    </tr>
  </tbody>
</table>
</div>




```python
# level0 索引
report_2015_df2.loc['Western Europe']
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Switzerland</th>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>6</td>
      <td>7.406</td>
      <td>0.03140</td>
      <td>1.29025</td>
      <td>1.31826</td>
      <td>0.88911</td>
      <td>0.64169</td>
      <td>0.41372</td>
      <td>0.23351</td>
      <td>2.61955</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>7</td>
      <td>7.378</td>
      <td>0.02799</td>
      <td>1.32944</td>
      <td>1.28017</td>
      <td>0.89284</td>
      <td>0.61576</td>
      <td>0.31814</td>
      <td>0.47610</td>
      <td>2.46570</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>8</td>
      <td>7.364</td>
      <td>0.03157</td>
      <td>1.33171</td>
      <td>1.28907</td>
      <td>0.91087</td>
      <td>0.65980</td>
      <td>0.43844</td>
      <td>0.36262</td>
      <td>2.37119</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>13</td>
      <td>7.200</td>
      <td>0.03751</td>
      <td>1.33723</td>
      <td>1.29704</td>
      <td>0.89042</td>
      <td>0.62433</td>
      <td>0.18676</td>
      <td>0.33088</td>
      <td>2.53320</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>17</td>
      <td>6.946</td>
      <td>0.03499</td>
      <td>1.56391</td>
      <td>1.21963</td>
      <td>0.91894</td>
      <td>0.61583</td>
      <td>0.37798</td>
      <td>0.28034</td>
      <td>1.96961</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>18</td>
      <td>6.940</td>
      <td>0.03676</td>
      <td>1.33596</td>
      <td>1.36948</td>
      <td>0.89533</td>
      <td>0.61777</td>
      <td>0.28703</td>
      <td>0.45901</td>
      <td>1.97570</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>19</td>
      <td>6.937</td>
      <td>0.03595</td>
      <td>1.30782</td>
      <td>1.28566</td>
      <td>0.89667</td>
      <td>0.58450</td>
      <td>0.22540</td>
      <td>0.22250</td>
      <td>2.41484</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>21</td>
      <td>6.867</td>
      <td>0.01866</td>
      <td>1.26637</td>
      <td>1.28548</td>
      <td>0.90943</td>
      <td>0.59625</td>
      <td>0.32067</td>
      <td>0.51912</td>
      <td>1.96994</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>26</td>
      <td>6.750</td>
      <td>0.01848</td>
      <td>1.32792</td>
      <td>1.29937</td>
      <td>0.89186</td>
      <td>0.61477</td>
      <td>0.21843</td>
      <td>0.28214</td>
      <td>2.11569</td>
    </tr>
    <tr>
      <th>France</th>
      <td>29</td>
      <td>6.575</td>
      <td>0.03512</td>
      <td>1.27778</td>
      <td>1.26038</td>
      <td>0.94579</td>
      <td>0.55011</td>
      <td>0.20646</td>
      <td>0.12332</td>
      <td>2.21126</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>36</td>
      <td>6.329</td>
      <td>0.03468</td>
      <td>1.23011</td>
      <td>1.31379</td>
      <td>0.95562</td>
      <td>0.45951</td>
      <td>0.06398</td>
      <td>0.18227</td>
      <td>2.12367</td>
    </tr>
    <tr>
      <th>Malta</th>
      <td>37</td>
      <td>6.302</td>
      <td>0.04206</td>
      <td>1.20740</td>
      <td>1.30203</td>
      <td>0.88721</td>
      <td>0.60365</td>
      <td>0.13586</td>
      <td>0.51752</td>
      <td>1.64880</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>50</td>
      <td>5.948</td>
      <td>0.03914</td>
      <td>1.25114</td>
      <td>1.19777</td>
      <td>0.95446</td>
      <td>0.26236</td>
      <td>0.02901</td>
      <td>0.22823</td>
      <td>2.02518</td>
    </tr>
    <tr>
      <th>North Cyprus</th>
      <td>66</td>
      <td>5.695</td>
      <td>0.05635</td>
      <td>1.20806</td>
      <td>1.07008</td>
      <td>0.92356</td>
      <td>0.49027</td>
      <td>0.14280</td>
      <td>0.26169</td>
      <td>1.59888</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>67</td>
      <td>5.689</td>
      <td>0.05580</td>
      <td>1.20813</td>
      <td>0.89318</td>
      <td>0.92356</td>
      <td>0.40672</td>
      <td>0.06146</td>
      <td>0.30638</td>
      <td>1.88931</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>88</td>
      <td>5.102</td>
      <td>0.04802</td>
      <td>1.15991</td>
      <td>1.13935</td>
      <td>0.87519</td>
      <td>0.51469</td>
      <td>0.01078</td>
      <td>0.13719</td>
      <td>1.26462</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>102</td>
      <td>4.857</td>
      <td>0.05062</td>
      <td>1.15406</td>
      <td>0.92933</td>
      <td>0.88213</td>
      <td>0.07699</td>
      <td>0.01397</td>
      <td>0.00000</td>
      <td>1.80101</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 两层索引
report_2015_df2.loc['Western Europe', 'Switzerland']
```




    Happiness Rank                   1.00000
    Happiness Score                  7.58700
    Standard Error                   0.03411
    Economy (GDP per Capita)         1.39651
    Family                           1.34951
    Health (Life Expectancy)         0.94143
    Freedom                          0.66557
    Trust (Government Corruption)    0.41978
    Generosity                       0.29678
    Dystopia Residual                2.51738
    Name: (Western Europe, Switzerland), dtype: float64




```python
# 交换分层顺序
report_2015_df2.swaplevel()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Region</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Switzerland</th>
      <th>Western Europe</th>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <th>Western Europe</th>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <th>Western Europe</th>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>Norway</th>
      <th>Western Europe</th>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>Canada</th>
      <th>North America</th>
      <td>5</td>
      <td>7.427</td>
      <td>0.03553</td>
      <td>1.32629</td>
      <td>1.32261</td>
      <td>0.90563</td>
      <td>0.63297</td>
      <td>0.32957</td>
      <td>0.45811</td>
      <td>2.45176</td>
    </tr>
    <tr>
      <th>Finland</th>
      <th>Western Europe</th>
      <td>6</td>
      <td>7.406</td>
      <td>0.03140</td>
      <td>1.29025</td>
      <td>1.31826</td>
      <td>0.88911</td>
      <td>0.64169</td>
      <td>0.41372</td>
      <td>0.23351</td>
      <td>2.61955</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <th>Western Europe</th>
      <td>7</td>
      <td>7.378</td>
      <td>0.02799</td>
      <td>1.32944</td>
      <td>1.28017</td>
      <td>0.89284</td>
      <td>0.61576</td>
      <td>0.31814</td>
      <td>0.47610</td>
      <td>2.46570</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <th>Western Europe</th>
      <td>8</td>
      <td>7.364</td>
      <td>0.03157</td>
      <td>1.33171</td>
      <td>1.28907</td>
      <td>0.91087</td>
      <td>0.65980</td>
      <td>0.43844</td>
      <td>0.36262</td>
      <td>2.37119</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <th>Australia and New Zealand</th>
      <td>9</td>
      <td>7.286</td>
      <td>0.03371</td>
      <td>1.25018</td>
      <td>1.31967</td>
      <td>0.90837</td>
      <td>0.63938</td>
      <td>0.42922</td>
      <td>0.47501</td>
      <td>2.26425</td>
    </tr>
    <tr>
      <th>Australia</th>
      <th>Australia and New Zealand</th>
      <td>10</td>
      <td>7.284</td>
      <td>0.04083</td>
      <td>1.33358</td>
      <td>1.30923</td>
      <td>0.93156</td>
      <td>0.65124</td>
      <td>0.35637</td>
      <td>0.43562</td>
      <td>2.26646</td>
    </tr>
    <tr>
      <th>Israel</th>
      <th>Middle East and Northern Africa</th>
      <td>11</td>
      <td>7.278</td>
      <td>0.03470</td>
      <td>1.22857</td>
      <td>1.22393</td>
      <td>0.91387</td>
      <td>0.41319</td>
      <td>0.07785</td>
      <td>0.33172</td>
      <td>3.08854</td>
    </tr>
    <tr>
      <th>Costa Rica</th>
      <th>Latin America and Caribbean</th>
      <td>12</td>
      <td>7.226</td>
      <td>0.04454</td>
      <td>0.95578</td>
      <td>1.23788</td>
      <td>0.86027</td>
      <td>0.63376</td>
      <td>0.10583</td>
      <td>0.25497</td>
      <td>3.17728</td>
    </tr>
    <tr>
      <th>Austria</th>
      <th>Western Europe</th>
      <td>13</td>
      <td>7.200</td>
      <td>0.03751</td>
      <td>1.33723</td>
      <td>1.29704</td>
      <td>0.89042</td>
      <td>0.62433</td>
      <td>0.18676</td>
      <td>0.33088</td>
      <td>2.53320</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <th>Latin America and Caribbean</th>
      <td>14</td>
      <td>7.187</td>
      <td>0.04176</td>
      <td>1.02054</td>
      <td>0.91451</td>
      <td>0.81444</td>
      <td>0.48181</td>
      <td>0.21312</td>
      <td>0.14074</td>
      <td>3.60214</td>
    </tr>
    <tr>
      <th>United States</th>
      <th>North America</th>
      <td>15</td>
      <td>7.119</td>
      <td>0.03839</td>
      <td>1.39451</td>
      <td>1.24711</td>
      <td>0.86179</td>
      <td>0.54604</td>
      <td>0.15890</td>
      <td>0.40105</td>
      <td>2.51011</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <th>Latin America and Caribbean</th>
      <td>16</td>
      <td>6.983</td>
      <td>0.04076</td>
      <td>0.98124</td>
      <td>1.23287</td>
      <td>0.69702</td>
      <td>0.49049</td>
      <td>0.17521</td>
      <td>0.14574</td>
      <td>3.26001</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <th>Western Europe</th>
      <td>17</td>
      <td>6.946</td>
      <td>0.03499</td>
      <td>1.56391</td>
      <td>1.21963</td>
      <td>0.91894</td>
      <td>0.61583</td>
      <td>0.37798</td>
      <td>0.28034</td>
      <td>1.96961</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <th>Western Europe</th>
      <td>18</td>
      <td>6.940</td>
      <td>0.03676</td>
      <td>1.33596</td>
      <td>1.36948</td>
      <td>0.89533</td>
      <td>0.61777</td>
      <td>0.28703</td>
      <td>0.45901</td>
      <td>1.97570</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <th>Western Europe</th>
      <td>19</td>
      <td>6.937</td>
      <td>0.03595</td>
      <td>1.30782</td>
      <td>1.28566</td>
      <td>0.89667</td>
      <td>0.58450</td>
      <td>0.22540</td>
      <td>0.22250</td>
      <td>2.41484</td>
    </tr>
    <tr>
      <th>United Arab Emirates</th>
      <th>Middle East and Northern Africa</th>
      <td>20</td>
      <td>6.901</td>
      <td>0.03729</td>
      <td>1.42727</td>
      <td>1.12575</td>
      <td>0.80925</td>
      <td>0.64157</td>
      <td>0.38583</td>
      <td>0.26428</td>
      <td>2.24743</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <th>Western Europe</th>
      <td>21</td>
      <td>6.867</td>
      <td>0.01866</td>
      <td>1.26637</td>
      <td>1.28548</td>
      <td>0.90943</td>
      <td>0.59625</td>
      <td>0.32067</td>
      <td>0.51912</td>
      <td>1.96994</td>
    </tr>
    <tr>
      <th>Oman</th>
      <th>Middle East and Northern Africa</th>
      <td>22</td>
      <td>6.853</td>
      <td>0.05335</td>
      <td>1.36011</td>
      <td>1.08182</td>
      <td>0.76276</td>
      <td>0.63274</td>
      <td>0.32524</td>
      <td>0.21542</td>
      <td>2.47489</td>
    </tr>
    <tr>
      <th>Venezuela</th>
      <th>Latin America and Caribbean</th>
      <td>23</td>
      <td>6.810</td>
      <td>0.06476</td>
      <td>1.04424</td>
      <td>1.25596</td>
      <td>0.72052</td>
      <td>0.42908</td>
      <td>0.11069</td>
      <td>0.05841</td>
      <td>3.19131</td>
    </tr>
    <tr>
      <th>Singapore</th>
      <th>Southeastern Asia</th>
      <td>24</td>
      <td>6.798</td>
      <td>0.03780</td>
      <td>1.52186</td>
      <td>1.02000</td>
      <td>1.02525</td>
      <td>0.54252</td>
      <td>0.49210</td>
      <td>0.31105</td>
      <td>1.88501</td>
    </tr>
    <tr>
      <th>Panama</th>
      <th>Latin America and Caribbean</th>
      <td>25</td>
      <td>6.786</td>
      <td>0.04910</td>
      <td>1.06353</td>
      <td>1.19850</td>
      <td>0.79661</td>
      <td>0.54210</td>
      <td>0.09270</td>
      <td>0.24434</td>
      <td>2.84848</td>
    </tr>
    <tr>
      <th>Germany</th>
      <th>Western Europe</th>
      <td>26</td>
      <td>6.750</td>
      <td>0.01848</td>
      <td>1.32792</td>
      <td>1.29937</td>
      <td>0.89186</td>
      <td>0.61477</td>
      <td>0.21843</td>
      <td>0.28214</td>
      <td>2.11569</td>
    </tr>
    <tr>
      <th>Chile</th>
      <th>Latin America and Caribbean</th>
      <td>27</td>
      <td>6.670</td>
      <td>0.05800</td>
      <td>1.10715</td>
      <td>1.12447</td>
      <td>0.85857</td>
      <td>0.44132</td>
      <td>0.12869</td>
      <td>0.33363</td>
      <td>2.67585</td>
    </tr>
    <tr>
      <th>Qatar</th>
      <th>Middle East and Northern Africa</th>
      <td>28</td>
      <td>6.611</td>
      <td>0.06257</td>
      <td>1.69042</td>
      <td>1.07860</td>
      <td>0.79733</td>
      <td>0.64040</td>
      <td>0.52208</td>
      <td>0.32573</td>
      <td>1.55674</td>
    </tr>
    <tr>
      <th>France</th>
      <th>Western Europe</th>
      <td>29</td>
      <td>6.575</td>
      <td>0.03512</td>
      <td>1.27778</td>
      <td>1.26038</td>
      <td>0.94579</td>
      <td>0.55011</td>
      <td>0.20646</td>
      <td>0.12332</td>
      <td>2.21126</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <th>Latin America and Caribbean</th>
      <td>30</td>
      <td>6.574</td>
      <td>0.04612</td>
      <td>1.05351</td>
      <td>1.24823</td>
      <td>0.78723</td>
      <td>0.44974</td>
      <td>0.08484</td>
      <td>0.11451</td>
      <td>2.83600</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Myanmar</th>
      <th>Southeastern Asia</th>
      <td>129</td>
      <td>4.307</td>
      <td>0.04351</td>
      <td>0.27108</td>
      <td>0.70905</td>
      <td>0.48246</td>
      <td>0.44017</td>
      <td>0.19034</td>
      <td>0.79588</td>
      <td>1.41805</td>
    </tr>
    <tr>
      <th>Georgia</th>
      <th>Central and Eastern Europe</th>
      <td>130</td>
      <td>4.297</td>
      <td>0.04221</td>
      <td>0.74190</td>
      <td>0.38562</td>
      <td>0.72926</td>
      <td>0.40577</td>
      <td>0.38331</td>
      <td>0.05547</td>
      <td>1.59541</td>
    </tr>
    <tr>
      <th>Malawi</th>
      <th>Sub-Saharan Africa</th>
      <td>131</td>
      <td>4.292</td>
      <td>0.06130</td>
      <td>0.01604</td>
      <td>0.41134</td>
      <td>0.22562</td>
      <td>0.43054</td>
      <td>0.06977</td>
      <td>0.33128</td>
      <td>2.80791</td>
    </tr>
    <tr>
      <th>Sri Lanka</th>
      <th>Southern Asia</th>
      <td>132</td>
      <td>4.271</td>
      <td>0.03751</td>
      <td>0.83524</td>
      <td>1.01905</td>
      <td>0.70806</td>
      <td>0.53726</td>
      <td>0.09179</td>
      <td>0.40828</td>
      <td>0.67108</td>
    </tr>
    <tr>
      <th>Cameroon</th>
      <th>Sub-Saharan Africa</th>
      <td>133</td>
      <td>4.252</td>
      <td>0.04678</td>
      <td>0.42250</td>
      <td>0.88767</td>
      <td>0.23402</td>
      <td>0.49309</td>
      <td>0.05786</td>
      <td>0.20618</td>
      <td>1.95071</td>
    </tr>
    <tr>
      <th>Bulgaria</th>
      <th>Central and Eastern Europe</th>
      <td>134</td>
      <td>4.218</td>
      <td>0.04828</td>
      <td>1.01216</td>
      <td>1.10614</td>
      <td>0.76649</td>
      <td>0.30587</td>
      <td>0.00872</td>
      <td>0.11921</td>
      <td>0.89991</td>
    </tr>
    <tr>
      <th>Egypt</th>
      <th>Middle East and Northern Africa</th>
      <td>135</td>
      <td>4.194</td>
      <td>0.03260</td>
      <td>0.88180</td>
      <td>0.74700</td>
      <td>0.61712</td>
      <td>0.17288</td>
      <td>0.06324</td>
      <td>0.11291</td>
      <td>1.59927</td>
    </tr>
    <tr>
      <th>Yemen</th>
      <th>Middle East and Northern Africa</th>
      <td>136</td>
      <td>4.077</td>
      <td>0.04367</td>
      <td>0.54649</td>
      <td>0.68093</td>
      <td>0.40064</td>
      <td>0.35571</td>
      <td>0.07854</td>
      <td>0.09131</td>
      <td>1.92313</td>
    </tr>
    <tr>
      <th>Angola</th>
      <th>Sub-Saharan Africa</th>
      <td>137</td>
      <td>4.033</td>
      <td>0.04758</td>
      <td>0.75778</td>
      <td>0.86040</td>
      <td>0.16683</td>
      <td>0.10384</td>
      <td>0.07122</td>
      <td>0.12344</td>
      <td>1.94939</td>
    </tr>
    <tr>
      <th>Mali</th>
      <th>Sub-Saharan Africa</th>
      <td>138</td>
      <td>3.995</td>
      <td>0.05602</td>
      <td>0.26074</td>
      <td>1.03526</td>
      <td>0.20583</td>
      <td>0.38857</td>
      <td>0.12352</td>
      <td>0.18798</td>
      <td>1.79293</td>
    </tr>
    <tr>
      <th>Congo (Brazzaville)</th>
      <th>Sub-Saharan Africa</th>
      <td>139</td>
      <td>3.989</td>
      <td>0.06682</td>
      <td>0.67866</td>
      <td>0.66290</td>
      <td>0.31051</td>
      <td>0.41466</td>
      <td>0.11686</td>
      <td>0.12388</td>
      <td>1.68135</td>
    </tr>
    <tr>
      <th>Comoros</th>
      <th>Sub-Saharan Africa</th>
      <td>140</td>
      <td>3.956</td>
      <td>0.04797</td>
      <td>0.23906</td>
      <td>0.79273</td>
      <td>0.36315</td>
      <td>0.22917</td>
      <td>0.19900</td>
      <td>0.17441</td>
      <td>1.95812</td>
    </tr>
    <tr>
      <th>Uganda</th>
      <th>Sub-Saharan Africa</th>
      <td>141</td>
      <td>3.931</td>
      <td>0.04317</td>
      <td>0.21102</td>
      <td>1.13299</td>
      <td>0.33861</td>
      <td>0.45727</td>
      <td>0.07267</td>
      <td>0.29066</td>
      <td>1.42766</td>
    </tr>
    <tr>
      <th>Senegal</th>
      <th>Sub-Saharan Africa</th>
      <td>142</td>
      <td>3.904</td>
      <td>0.03608</td>
      <td>0.36498</td>
      <td>0.97619</td>
      <td>0.43540</td>
      <td>0.36772</td>
      <td>0.10713</td>
      <td>0.20843</td>
      <td>1.44395</td>
    </tr>
    <tr>
      <th>Gabon</th>
      <th>Sub-Saharan Africa</th>
      <td>143</td>
      <td>3.896</td>
      <td>0.04547</td>
      <td>1.06024</td>
      <td>0.90528</td>
      <td>0.43372</td>
      <td>0.31914</td>
      <td>0.11091</td>
      <td>0.06822</td>
      <td>0.99895</td>
    </tr>
    <tr>
      <th>Niger</th>
      <th>Sub-Saharan Africa</th>
      <td>144</td>
      <td>3.845</td>
      <td>0.03602</td>
      <td>0.06940</td>
      <td>0.77265</td>
      <td>0.29707</td>
      <td>0.47692</td>
      <td>0.15639</td>
      <td>0.19387</td>
      <td>1.87877</td>
    </tr>
    <tr>
      <th>Cambodia</th>
      <th>Southeastern Asia</th>
      <td>145</td>
      <td>3.819</td>
      <td>0.05069</td>
      <td>0.46038</td>
      <td>0.62736</td>
      <td>0.61114</td>
      <td>0.66246</td>
      <td>0.07247</td>
      <td>0.40359</td>
      <td>0.98195</td>
    </tr>
    <tr>
      <th>Tanzania</th>
      <th>Sub-Saharan Africa</th>
      <td>146</td>
      <td>3.781</td>
      <td>0.05061</td>
      <td>0.28520</td>
      <td>1.00268</td>
      <td>0.38215</td>
      <td>0.32878</td>
      <td>0.05747</td>
      <td>0.34377</td>
      <td>1.38079</td>
    </tr>
    <tr>
      <th>Madagascar</th>
      <th>Sub-Saharan Africa</th>
      <td>147</td>
      <td>3.681</td>
      <td>0.03633</td>
      <td>0.20824</td>
      <td>0.66801</td>
      <td>0.46721</td>
      <td>0.19184</td>
      <td>0.08124</td>
      <td>0.21333</td>
      <td>1.85100</td>
    </tr>
    <tr>
      <th>Central African Republic</th>
      <th>Sub-Saharan Africa</th>
      <td>148</td>
      <td>3.678</td>
      <td>0.06112</td>
      <td>0.07850</td>
      <td>0.00000</td>
      <td>0.06699</td>
      <td>0.48879</td>
      <td>0.08289</td>
      <td>0.23835</td>
      <td>2.72230</td>
    </tr>
    <tr>
      <th>Chad</th>
      <th>Sub-Saharan Africa</th>
      <td>149</td>
      <td>3.667</td>
      <td>0.03830</td>
      <td>0.34193</td>
      <td>0.76062</td>
      <td>0.15010</td>
      <td>0.23501</td>
      <td>0.05269</td>
      <td>0.18386</td>
      <td>1.94296</td>
    </tr>
    <tr>
      <th>Guinea</th>
      <th>Sub-Saharan Africa</th>
      <td>150</td>
      <td>3.656</td>
      <td>0.03590</td>
      <td>0.17417</td>
      <td>0.46475</td>
      <td>0.24009</td>
      <td>0.37725</td>
      <td>0.12139</td>
      <td>0.28657</td>
      <td>1.99172</td>
    </tr>
    <tr>
      <th>Ivory Coast</th>
      <th>Sub-Saharan Africa</th>
      <td>151</td>
      <td>3.655</td>
      <td>0.05141</td>
      <td>0.46534</td>
      <td>0.77115</td>
      <td>0.15185</td>
      <td>0.46866</td>
      <td>0.17922</td>
      <td>0.20165</td>
      <td>1.41723</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <th>Sub-Saharan Africa</th>
      <td>152</td>
      <td>3.587</td>
      <td>0.04324</td>
      <td>0.25812</td>
      <td>0.85188</td>
      <td>0.27125</td>
      <td>0.39493</td>
      <td>0.12832</td>
      <td>0.21747</td>
      <td>1.46494</td>
    </tr>
    <tr>
      <th>Afghanistan</th>
      <th>Southern Asia</th>
      <td>153</td>
      <td>3.575</td>
      <td>0.03084</td>
      <td>0.31982</td>
      <td>0.30285</td>
      <td>0.30335</td>
      <td>0.23414</td>
      <td>0.09719</td>
      <td>0.36510</td>
      <td>1.95210</td>
    </tr>
    <tr>
      <th>Rwanda</th>
      <th>Sub-Saharan Africa</th>
      <td>154</td>
      <td>3.465</td>
      <td>0.03464</td>
      <td>0.22208</td>
      <td>0.77370</td>
      <td>0.42864</td>
      <td>0.59201</td>
      <td>0.55191</td>
      <td>0.22628</td>
      <td>0.67042</td>
    </tr>
    <tr>
      <th>Benin</th>
      <th>Sub-Saharan Africa</th>
      <td>155</td>
      <td>3.340</td>
      <td>0.03656</td>
      <td>0.28665</td>
      <td>0.35386</td>
      <td>0.31910</td>
      <td>0.48450</td>
      <td>0.08010</td>
      <td>0.18260</td>
      <td>1.63328</td>
    </tr>
    <tr>
      <th>Syria</th>
      <th>Middle East and Northern Africa</th>
      <td>156</td>
      <td>3.006</td>
      <td>0.05015</td>
      <td>0.66320</td>
      <td>0.47489</td>
      <td>0.72193</td>
      <td>0.15684</td>
      <td>0.18906</td>
      <td>0.47179</td>
      <td>0.32858</td>
    </tr>
    <tr>
      <th>Burundi</th>
      <th>Sub-Saharan Africa</th>
      <td>157</td>
      <td>2.905</td>
      <td>0.08658</td>
      <td>0.01530</td>
      <td>0.41587</td>
      <td>0.22396</td>
      <td>0.11850</td>
      <td>0.10062</td>
      <td>0.19727</td>
      <td>1.83302</td>
    </tr>
    <tr>
      <th>Togo</th>
      <th>Sub-Saharan Africa</th>
      <td>158</td>
      <td>2.839</td>
      <td>0.06727</td>
      <td>0.20868</td>
      <td>0.13995</td>
      <td>0.28443</td>
      <td>0.36453</td>
      <td>0.10731</td>
      <td>0.16681</td>
      <td>1.56726</td>
    </tr>
  </tbody>
</table>
<p>158 rows × 10 columns</p>
</div>




```python
# 排序分层
report_2015_df2.sort_index(level=0)
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Happiness Rank</th>
      <th>Happiness Score</th>
      <th>Standard Error</th>
      <th>Economy (GDP per Capita)</th>
      <th>Family</th>
      <th>Health (Life Expectancy)</th>
      <th>Freedom</th>
      <th>Trust (Government Corruption)</th>
      <th>Generosity</th>
      <th>Dystopia Residual</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia and New Zealand</th>
      <th>Australia</th>
      <td>10</td>
      <td>7.284</td>
      <td>0.04083</td>
      <td>1.33358</td>
      <td>1.30923</td>
      <td>0.93156</td>
      <td>0.65124</td>
      <td>0.35637</td>
      <td>0.43562</td>
      <td>2.26646</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>9</td>
      <td>7.286</td>
      <td>0.03371</td>
      <td>1.25018</td>
      <td>1.31967</td>
      <td>0.90837</td>
      <td>0.63938</td>
      <td>0.42922</td>
      <td>0.47501</td>
      <td>2.26425</td>
    </tr>
    <tr>
      <th rowspan="28" valign="top">Central and Eastern Europe</th>
      <th>Albania</th>
      <td>95</td>
      <td>4.959</td>
      <td>0.05013</td>
      <td>0.87867</td>
      <td>0.80434</td>
      <td>0.81325</td>
      <td>0.35733</td>
      <td>0.06413</td>
      <td>0.14272</td>
      <td>1.89894</td>
    </tr>
    <tr>
      <th>Armenia</th>
      <td>127</td>
      <td>4.350</td>
      <td>0.04763</td>
      <td>0.76821</td>
      <td>0.77711</td>
      <td>0.72990</td>
      <td>0.19847</td>
      <td>0.03900</td>
      <td>0.07855</td>
      <td>1.75873</td>
    </tr>
    <tr>
      <th>Azerbaijan</th>
      <td>80</td>
      <td>5.212</td>
      <td>0.03363</td>
      <td>1.02389</td>
      <td>0.93793</td>
      <td>0.64045</td>
      <td>0.37030</td>
      <td>0.16065</td>
      <td>0.07799</td>
      <td>2.00073</td>
    </tr>
    <tr>
      <th>Belarus</th>
      <td>59</td>
      <td>5.813</td>
      <td>0.03938</td>
      <td>1.03192</td>
      <td>1.23289</td>
      <td>0.73608</td>
      <td>0.37938</td>
      <td>0.19090</td>
      <td>0.11046</td>
      <td>2.13090</td>
    </tr>
    <tr>
      <th>Bosnia and Herzegovina</th>
      <td>96</td>
      <td>4.949</td>
      <td>0.06913</td>
      <td>0.83223</td>
      <td>0.91916</td>
      <td>0.79081</td>
      <td>0.09245</td>
      <td>0.00227</td>
      <td>0.24808</td>
      <td>2.06367</td>
    </tr>
    <tr>
      <th>Bulgaria</th>
      <td>134</td>
      <td>4.218</td>
      <td>0.04828</td>
      <td>1.01216</td>
      <td>1.10614</td>
      <td>0.76649</td>
      <td>0.30587</td>
      <td>0.00872</td>
      <td>0.11921</td>
      <td>0.89991</td>
    </tr>
    <tr>
      <th>Croatia</th>
      <td>62</td>
      <td>5.759</td>
      <td>0.04394</td>
      <td>1.08254</td>
      <td>0.79624</td>
      <td>0.78805</td>
      <td>0.25883</td>
      <td>0.02430</td>
      <td>0.05444</td>
      <td>2.75414</td>
    </tr>
    <tr>
      <th>Czech Republic</th>
      <td>31</td>
      <td>6.505</td>
      <td>0.04168</td>
      <td>1.17898</td>
      <td>1.20643</td>
      <td>0.84483</td>
      <td>0.46364</td>
      <td>0.02652</td>
      <td>0.10686</td>
      <td>2.67782</td>
    </tr>
    <tr>
      <th>Estonia</th>
      <td>73</td>
      <td>5.429</td>
      <td>0.04013</td>
      <td>1.15174</td>
      <td>1.22791</td>
      <td>0.77361</td>
      <td>0.44888</td>
      <td>0.15184</td>
      <td>0.08680</td>
      <td>1.58782</td>
    </tr>
    <tr>
      <th>Georgia</th>
      <td>130</td>
      <td>4.297</td>
      <td>0.04221</td>
      <td>0.74190</td>
      <td>0.38562</td>
      <td>0.72926</td>
      <td>0.40577</td>
      <td>0.38331</td>
      <td>0.05547</td>
      <td>1.59541</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>104</td>
      <td>4.800</td>
      <td>0.06107</td>
      <td>1.12094</td>
      <td>1.20215</td>
      <td>0.75905</td>
      <td>0.32112</td>
      <td>0.02758</td>
      <td>0.12800</td>
      <td>1.24074</td>
    </tr>
    <tr>
      <th>Kazakhstan</th>
      <td>54</td>
      <td>5.855</td>
      <td>0.04114</td>
      <td>1.12254</td>
      <td>1.12241</td>
      <td>0.64368</td>
      <td>0.51649</td>
      <td>0.08454</td>
      <td>0.11827</td>
      <td>2.24729</td>
    </tr>
    <tr>
      <th>Kosovo</th>
      <td>69</td>
      <td>5.589</td>
      <td>0.05018</td>
      <td>0.80148</td>
      <td>0.81198</td>
      <td>0.63132</td>
      <td>0.24749</td>
      <td>0.04741</td>
      <td>0.28310</td>
      <td>2.76579</td>
    </tr>
    <tr>
      <th>Kyrgyzstan</th>
      <td>77</td>
      <td>5.286</td>
      <td>0.03823</td>
      <td>0.47428</td>
      <td>1.15115</td>
      <td>0.65088</td>
      <td>0.43477</td>
      <td>0.04232</td>
      <td>0.30030</td>
      <td>2.23270</td>
    </tr>
    <tr>
      <th>Latvia</th>
      <td>89</td>
      <td>5.098</td>
      <td>0.04640</td>
      <td>1.11312</td>
      <td>1.09562</td>
      <td>0.72437</td>
      <td>0.29671</td>
      <td>0.06332</td>
      <td>0.18226</td>
      <td>1.62215</td>
    </tr>
    <tr>
      <th>Lithuania</th>
      <td>56</td>
      <td>5.833</td>
      <td>0.03843</td>
      <td>1.14723</td>
      <td>1.25745</td>
      <td>0.73128</td>
      <td>0.21342</td>
      <td>0.01031</td>
      <td>0.02641</td>
      <td>2.44649</td>
    </tr>
    <tr>
      <th>Macedonia</th>
      <td>93</td>
      <td>5.007</td>
      <td>0.05376</td>
      <td>0.91851</td>
      <td>1.00232</td>
      <td>0.73545</td>
      <td>0.33457</td>
      <td>0.05327</td>
      <td>0.22359</td>
      <td>1.73933</td>
    </tr>
    <tr>
      <th>Moldova</th>
      <td>52</td>
      <td>5.889</td>
      <td>0.03799</td>
      <td>0.59448</td>
      <td>1.01528</td>
      <td>0.61826</td>
      <td>0.32818</td>
      <td>0.01615</td>
      <td>0.20951</td>
      <td>3.10712</td>
    </tr>
    <tr>
      <th>Montenegro</th>
      <td>82</td>
      <td>5.192</td>
      <td>0.05235</td>
      <td>0.97438</td>
      <td>0.90557</td>
      <td>0.72521</td>
      <td>0.18260</td>
      <td>0.14296</td>
      <td>0.16140</td>
      <td>2.10017</td>
    </tr>
    <tr>
      <th>Poland</th>
      <td>60</td>
      <td>5.791</td>
      <td>0.04263</td>
      <td>1.12555</td>
      <td>1.27948</td>
      <td>0.77903</td>
      <td>0.53122</td>
      <td>0.04212</td>
      <td>0.16759</td>
      <td>1.86565</td>
    </tr>
    <tr>
      <th>Romania</th>
      <td>86</td>
      <td>5.124</td>
      <td>0.06607</td>
      <td>1.04345</td>
      <td>0.88588</td>
      <td>0.76890</td>
      <td>0.35068</td>
      <td>0.00649</td>
      <td>0.13748</td>
      <td>1.93129</td>
    </tr>
    <tr>
      <th>Russia</th>
      <td>64</td>
      <td>5.716</td>
      <td>0.03135</td>
      <td>1.13764</td>
      <td>1.23617</td>
      <td>0.66926</td>
      <td>0.36679</td>
      <td>0.03005</td>
      <td>0.00199</td>
      <td>2.27394</td>
    </tr>
    <tr>
      <th>Serbia</th>
      <td>87</td>
      <td>5.123</td>
      <td>0.04864</td>
      <td>0.92053</td>
      <td>1.00964</td>
      <td>0.74836</td>
      <td>0.20107</td>
      <td>0.02617</td>
      <td>0.19231</td>
      <td>2.02500</td>
    </tr>
    <tr>
      <th>Slovakia</th>
      <td>45</td>
      <td>5.995</td>
      <td>0.04267</td>
      <td>1.16891</td>
      <td>1.26999</td>
      <td>0.78902</td>
      <td>0.31751</td>
      <td>0.03431</td>
      <td>0.16893</td>
      <td>2.24639</td>
    </tr>
    <tr>
      <th>Slovenia</th>
      <td>55</td>
      <td>5.848</td>
      <td>0.04251</td>
      <td>1.18498</td>
      <td>1.27385</td>
      <td>0.87337</td>
      <td>0.60855</td>
      <td>0.03787</td>
      <td>0.25328</td>
      <td>1.61583</td>
    </tr>
    <tr>
      <th>Tajikistan</th>
      <td>106</td>
      <td>4.786</td>
      <td>0.03198</td>
      <td>0.39047</td>
      <td>0.85563</td>
      <td>0.57379</td>
      <td>0.47216</td>
      <td>0.15072</td>
      <td>0.22974</td>
      <td>2.11399</td>
    </tr>
    <tr>
      <th>Turkmenistan</th>
      <td>70</td>
      <td>5.548</td>
      <td>0.04175</td>
      <td>0.95847</td>
      <td>1.22668</td>
      <td>0.53886</td>
      <td>0.47610</td>
      <td>0.30844</td>
      <td>0.16979</td>
      <td>1.86984</td>
    </tr>
    <tr>
      <th>Ukraine</th>
      <td>111</td>
      <td>4.681</td>
      <td>0.04412</td>
      <td>0.79907</td>
      <td>1.20278</td>
      <td>0.67390</td>
      <td>0.25123</td>
      <td>0.02961</td>
      <td>0.15275</td>
      <td>1.57140</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">Sub-Saharan Africa</th>
      <th>Somaliland region</th>
      <td>91</td>
      <td>5.057</td>
      <td>0.06161</td>
      <td>0.18847</td>
      <td>0.95152</td>
      <td>0.43873</td>
      <td>0.46582</td>
      <td>0.39928</td>
      <td>0.50318</td>
      <td>2.11032</td>
    </tr>
    <tr>
      <th>South Africa</th>
      <td>113</td>
      <td>4.642</td>
      <td>0.04585</td>
      <td>0.92049</td>
      <td>1.18468</td>
      <td>0.27688</td>
      <td>0.33207</td>
      <td>0.08884</td>
      <td>0.11973</td>
      <td>1.71956</td>
    </tr>
    <tr>
      <th>Sudan</th>
      <td>118</td>
      <td>4.550</td>
      <td>0.06740</td>
      <td>0.52107</td>
      <td>1.01404</td>
      <td>0.36878</td>
      <td>0.10081</td>
      <td>0.14660</td>
      <td>0.19062</td>
      <td>2.20857</td>
    </tr>
    <tr>
      <th>Swaziland</th>
      <td>101</td>
      <td>4.867</td>
      <td>0.08742</td>
      <td>0.71206</td>
      <td>1.07284</td>
      <td>0.07566</td>
      <td>0.30658</td>
      <td>0.03060</td>
      <td>0.18259</td>
      <td>2.48676</td>
    </tr>
    <tr>
      <th>Tanzania</th>
      <td>146</td>
      <td>3.781</td>
      <td>0.05061</td>
      <td>0.28520</td>
      <td>1.00268</td>
      <td>0.38215</td>
      <td>0.32878</td>
      <td>0.05747</td>
      <td>0.34377</td>
      <td>1.38079</td>
    </tr>
    <tr>
      <th>Togo</th>
      <td>158</td>
      <td>2.839</td>
      <td>0.06727</td>
      <td>0.20868</td>
      <td>0.13995</td>
      <td>0.28443</td>
      <td>0.36453</td>
      <td>0.10731</td>
      <td>0.16681</td>
      <td>1.56726</td>
    </tr>
    <tr>
      <th>Uganda</th>
      <td>141</td>
      <td>3.931</td>
      <td>0.04317</td>
      <td>0.21102</td>
      <td>1.13299</td>
      <td>0.33861</td>
      <td>0.45727</td>
      <td>0.07267</td>
      <td>0.29066</td>
      <td>1.42766</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>85</td>
      <td>5.129</td>
      <td>0.06988</td>
      <td>0.47038</td>
      <td>0.91612</td>
      <td>0.29924</td>
      <td>0.48827</td>
      <td>0.12468</td>
      <td>0.19591</td>
      <td>2.63430</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>115</td>
      <td>4.610</td>
      <td>0.04290</td>
      <td>0.27100</td>
      <td>1.03276</td>
      <td>0.33475</td>
      <td>0.25861</td>
      <td>0.08079</td>
      <td>0.18987</td>
      <td>2.44191</td>
    </tr>
    <tr>
      <th rowspan="21" valign="top">Western Europe</th>
      <th>Austria</th>
      <td>13</td>
      <td>7.200</td>
      <td>0.03751</td>
      <td>1.33723</td>
      <td>1.29704</td>
      <td>0.89042</td>
      <td>0.62433</td>
      <td>0.18676</td>
      <td>0.33088</td>
      <td>2.53320</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>19</td>
      <td>6.937</td>
      <td>0.03595</td>
      <td>1.30782</td>
      <td>1.28566</td>
      <td>0.89667</td>
      <td>0.58450</td>
      <td>0.22540</td>
      <td>0.22250</td>
      <td>2.41484</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>67</td>
      <td>5.689</td>
      <td>0.05580</td>
      <td>1.20813</td>
      <td>0.89318</td>
      <td>0.92356</td>
      <td>0.40672</td>
      <td>0.06146</td>
      <td>0.30638</td>
      <td>1.88931</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>3</td>
      <td>7.527</td>
      <td>0.03328</td>
      <td>1.32548</td>
      <td>1.36058</td>
      <td>0.87464</td>
      <td>0.64938</td>
      <td>0.48357</td>
      <td>0.34139</td>
      <td>2.49204</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>6</td>
      <td>7.406</td>
      <td>0.03140</td>
      <td>1.29025</td>
      <td>1.31826</td>
      <td>0.88911</td>
      <td>0.64169</td>
      <td>0.41372</td>
      <td>0.23351</td>
      <td>2.61955</td>
    </tr>
    <tr>
      <th>France</th>
      <td>29</td>
      <td>6.575</td>
      <td>0.03512</td>
      <td>1.27778</td>
      <td>1.26038</td>
      <td>0.94579</td>
      <td>0.55011</td>
      <td>0.20646</td>
      <td>0.12332</td>
      <td>2.21126</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>26</td>
      <td>6.750</td>
      <td>0.01848</td>
      <td>1.32792</td>
      <td>1.29937</td>
      <td>0.89186</td>
      <td>0.61477</td>
      <td>0.21843</td>
      <td>0.28214</td>
      <td>2.11569</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>102</td>
      <td>4.857</td>
      <td>0.05062</td>
      <td>1.15406</td>
      <td>0.92933</td>
      <td>0.88213</td>
      <td>0.07699</td>
      <td>0.01397</td>
      <td>0.00000</td>
      <td>1.80101</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>2</td>
      <td>7.561</td>
      <td>0.04884</td>
      <td>1.30232</td>
      <td>1.40223</td>
      <td>0.94784</td>
      <td>0.62877</td>
      <td>0.14145</td>
      <td>0.43630</td>
      <td>2.70201</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>18</td>
      <td>6.940</td>
      <td>0.03676</td>
      <td>1.33596</td>
      <td>1.36948</td>
      <td>0.89533</td>
      <td>0.61777</td>
      <td>0.28703</td>
      <td>0.45901</td>
      <td>1.97570</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>50</td>
      <td>5.948</td>
      <td>0.03914</td>
      <td>1.25114</td>
      <td>1.19777</td>
      <td>0.95446</td>
      <td>0.26236</td>
      <td>0.02901</td>
      <td>0.22823</td>
      <td>2.02518</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>17</td>
      <td>6.946</td>
      <td>0.03499</td>
      <td>1.56391</td>
      <td>1.21963</td>
      <td>0.91894</td>
      <td>0.61583</td>
      <td>0.37798</td>
      <td>0.28034</td>
      <td>1.96961</td>
    </tr>
    <tr>
      <th>Malta</th>
      <td>37</td>
      <td>6.302</td>
      <td>0.04206</td>
      <td>1.20740</td>
      <td>1.30203</td>
      <td>0.88721</td>
      <td>0.60365</td>
      <td>0.13586</td>
      <td>0.51752</td>
      <td>1.64880</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>7</td>
      <td>7.378</td>
      <td>0.02799</td>
      <td>1.32944</td>
      <td>1.28017</td>
      <td>0.89284</td>
      <td>0.61576</td>
      <td>0.31814</td>
      <td>0.47610</td>
      <td>2.46570</td>
    </tr>
    <tr>
      <th>North Cyprus</th>
      <td>66</td>
      <td>5.695</td>
      <td>0.05635</td>
      <td>1.20806</td>
      <td>1.07008</td>
      <td>0.92356</td>
      <td>0.49027</td>
      <td>0.14280</td>
      <td>0.26169</td>
      <td>1.59888</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>4</td>
      <td>7.522</td>
      <td>0.03880</td>
      <td>1.45900</td>
      <td>1.33095</td>
      <td>0.88521</td>
      <td>0.66973</td>
      <td>0.36503</td>
      <td>0.34699</td>
      <td>2.46531</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>88</td>
      <td>5.102</td>
      <td>0.04802</td>
      <td>1.15991</td>
      <td>1.13935</td>
      <td>0.87519</td>
      <td>0.51469</td>
      <td>0.01078</td>
      <td>0.13719</td>
      <td>1.26462</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>36</td>
      <td>6.329</td>
      <td>0.03468</td>
      <td>1.23011</td>
      <td>1.31379</td>
      <td>0.95562</td>
      <td>0.45951</td>
      <td>0.06398</td>
      <td>0.18227</td>
      <td>2.12367</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>8</td>
      <td>7.364</td>
      <td>0.03157</td>
      <td>1.33171</td>
      <td>1.28907</td>
      <td>0.91087</td>
      <td>0.65980</td>
      <td>0.43844</td>
      <td>0.36262</td>
      <td>2.37119</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>1</td>
      <td>7.587</td>
      <td>0.03411</td>
      <td>1.39651</td>
      <td>1.34951</td>
      <td>0.94143</td>
      <td>0.66557</td>
      <td>0.41978</td>
      <td>0.29678</td>
      <td>2.51738</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>21</td>
      <td>6.867</td>
      <td>0.01866</td>
      <td>1.26637</td>
      <td>1.28548</td>
      <td>0.90943</td>
      <td>0.59625</td>
      <td>0.32067</td>
      <td>0.51912</td>
      <td>1.96994</td>
    </tr>
  </tbody>
</table>
<p>158 rows × 10 columns</p>
</div>



## 7. 数据清洗


```python
log_data = pd.read_csv('log.csv')
log_data
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>user</th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1469974424</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1469974454</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1469974544</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1469974574</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1469977514</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1469977544</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1469977574</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1469977604</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1469974604</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1469974694</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>14</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1469974724</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1469974454</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>24</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1469974524</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1469974424</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1469974554</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>26</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1469974624</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>27</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1469974654</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>28</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1469974724</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>29</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1469974484</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1469974514</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1469974754</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>30</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1469974824</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>31</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1469974854</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>32</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1469974924</td>
      <td>sue</td>
      <td>advanced.html</td>
      <td>33</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1469977424</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1469977454</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1469977484</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1469977634</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1469977664</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1469974634</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1469974664</td>
      <td>cheryl</td>
      <td>intro.html</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1469977694</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1469977724</td>
      <td>bob</td>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
log_data.set_index(['time', 'user'], inplace=True)
log_data.sort_index(inplace=True)
log_data
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1469974424</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974454</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>24</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974484</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974514</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974524</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974544</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974554</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>26</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974574</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974604</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974624</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>27</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974634</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974654</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>28</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974664</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974694</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>14</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974724</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>29</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974754</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>30</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974824</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>31</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974854</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>32</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469974924</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>33</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977424</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977454</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977484</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977514</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977544</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977574</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977604</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977634</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977664</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977694</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977724</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
log_data.fillna(0)
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1469974424</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974454</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>6</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>24</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974484</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>7</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974514</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>8</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974524</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>25</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974544</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>9</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974554</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>26</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974574</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>10</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974604</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>11</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974624</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>27</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974634</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>12</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974654</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>28</td>
      <td>0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974664</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>13</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974694</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>14</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974724</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>15</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>29</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974754</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>30</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974824</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>31</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974854</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>32</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469974924</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>33</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977424</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977454</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977484</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977514</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977544</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977574</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977604</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977634</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977664</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977694</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1469977724</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
log_data.dropna()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1469974424</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977424</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
log_data.ffill()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1469974424</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974454</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>6</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>24</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974484</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>7</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974514</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>8</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974524</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>25</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974544</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>9</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974554</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>26</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974574</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>10</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974604</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>11</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974624</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>27</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974634</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>12</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974654</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>28</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974664</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>13</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974694</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>14</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974724</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>15</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>29</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974754</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>30</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974824</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>31</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974854</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>32</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974924</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>33</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469977424</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977454</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977484</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977514</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977544</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977574</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977604</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977634</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977664</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977694</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977724</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
log_data.bfill()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video</th>
      <th>playback position</th>
      <th>paused</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1469974424</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>5</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>23</td>
      <td>False</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974454</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>6</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>24</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974484</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>7</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974514</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>8</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974524</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>25</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974544</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>9</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974554</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>26</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974574</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>10</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974604</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>11</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974624</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>27</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974634</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>12</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974654</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>28</td>
      <td>True</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1469974664</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>13</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974694</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>14</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1469974724</th>
      <th>cheryl</th>
      <td>intro.html</td>
      <td>15</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>sue</th>
      <td>advanced.html</td>
      <td>29</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974754</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>30</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974824</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>31</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974854</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>32</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469974924</th>
      <th>sue</th>
      <td>advanced.html</td>
      <td>33</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977424</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>True</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1469977454</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977484</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977514</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977544</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977574</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977604</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977634</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977664</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977694</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1469977724</th>
      <th>bob</th>
      <td>intro.html</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
